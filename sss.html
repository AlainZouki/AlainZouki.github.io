<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Distinct vCenter Values</title>
  <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
</head>
<body>
  <h1>Distinct vCenter Values</h1>

  <!-- Div to display distinct vCenter values -->
  <div id="vCenterValues" style="font-size: 18px;">
    No vCenter values available.
  </div>

  <script>
    // Grist Plugin API ready
    grist.ready();

    // Fetch all records from the Grist table
    grist.getRecords().then(function(records) {
      // Check if records are available
      if (!Array.isArray(records) || records.length === 0) {
        document.getElementById('vCenterValues').innerText = 'No vCenter values available.';
        return;
      }

      // Extract distinct vCenter values
      const distinctVCenters = [...new Set(records.map(record => record.vCenter).filter(Boolean))];

      // Update the display with distinct values
      if (distinctVCenters.length > 0) {
        document.getElementById('vCenterValues').innerText = 'Distinct vCenter Values: ' + distinctVCenters.join(', ');
      } else {
        document.getElementById('vCenterValues').innerText = 'No vCenter values available.';
      }
    }).catch(function(error) {
      document.getElementById('vCenterValues').innerText = 'Error fetching data from Grist: ' + error.message;
    });
  </script>
</body>
</html>
